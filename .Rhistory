library(tidyverse)
library(haven)
data <- read_dta("original&computed_DB_forrep.dta")
summary(data)
library(tidyverse)
library(haven)
data <- read_dta("original&computed_DB_forrep.dta")
summary(data)
library(tidyverse)
library(haven)
library(ggplot2)
data <- read_dta("original&computed_DB_forrep.dta")
# Count of NAs per column
colSums(is.na(data))
# Percentage of missing values
colSums(is.na(data)) / nrow(data) * 100
num_vars <- names(Filter(is.numeric, data))
for (v in num_vars) {
print(
ggplot(data, aes_string(x = v)) +
geom_histogram(bins = 30) +
ggtitle(paste("Histogram of", v))
)
}
library(tidyverse)
library(haven)
library(ggplot2)
data <- read_dta("original&computed_DB_forrep.dta")
num_vars <- names(Filter(is.numeric, data))
for (v in num_vars) {
print(
ggplot(data, aes_string(x = v)) +
geom_histogram(bins = 30) +
ggtitle(paste("Histogram of", v))
)
}
summary(data$team_rank)
mean(data$team_rank)
sd(data$team_rank)
mean(data$team_rank)
sd(data$team_rank)^2
mean(data$score_home)
sd(data$score_home)^2
mean(data$score_home, na.rm = TRUE)
sd(data$score_home, na.rm = TRUE)^2
mean(data$teamdist_game, na.rm = TRUE)
sd(data$teamdist_game, na.rm = TRUE)^2
library(tidyverse)
library(haven)
library(ggplot2)
data <- read_dta("original&computed_DB_forrep.dta")
summary(data)
data %>%
keep(is.numeric) %>%                     # Keep only numeric columns
gather() %>%                             # Convert to key-value pairs
ggplot(aes(value)) +                     # Plot the values
facet_wrap(~ key, scales = "free") +   # In separate panels
geom_histogram()
# Count of NAs per column
colSums(is.na(data))
# Percentage of missing values
colSums(is.na(data)) / nrow(data) * 100
num_vars <- names(Filter(is.numeric, data))
for (v in num_vars) {
print(
ggplot(data, aes_string(x = v)) +
geom_histogram(bins = 30) +
ggtitle(paste("Histogram of", v))
)
}
View(data)
not_num <- setdiff(names(data), num_VARS)
#not numeric variables
not_num <- setdiff(names(data), num_vars)
View(data)
# sort the columns to be alphabetically ordered
data <- data[, order(names(data))]
summary(data)
data %>%
keep(is.numeric) %>%                     # Keep only numeric columns
gather() %>%                             # Convert to key-value pairs
ggplot(aes(value)) +                     # Plot the values
facet_wrap(~ key, scales = "free") +   # In separate panels
geom_histogram()
# sort the columns to be alphabetically ordered
data <- data[, order(names(data))]
# change dates to Date type
data$bdate <- as.Date(data$bdate, format = "%Y-%m-%d")
data$joineddate <- as.Date(data$joineddate, format = "%Y-%m-%d")
summary(data)
data %>%
keep(is.numeric) %>%                     # Keep only numeric columns
gather() %>%                             # Convert to key-value pairs
ggplot(aes(value)) +                     # Plot the values
facet_wrap(~ key, scales = "free") +   # In separate panels
geom_histogram()
# Count of NAs per column
colSums(is.na(data))
# Percentage of missing values
colSums(is.na(data)) / nrow(data) * 100
all_vars <- names(data)
for (v in all_vars) {
print(
ggplot(data, aes_string(x = v)) +
geom_histogram(bins = 30) +
ggtitle(paste("Histogram of", v))
)
}
library(tidyverse)
library(haven)
library(ggplot2)
library(dplyr)
# heatmap
# make a numeric-only version of your data:
data_num <- data %>%
mutate(across(where(inherits, "Date"), as.numeric))
# heatmap
# make a numeric-only version of your data:
data_num <- data %>%
mutate(across(where(inherits, "Date"), as.numeric))
# heatmap
# make a numeric-only version of your data:
data_num <- data %>%
mutate(across(
where(~ inherits(.x, "Date")),  # <- predicate: is it a Date?
as.numeric
))
# calculate correlations
cor_mat <- cor(data_num, use = "pairwise.complete.obs", method = "pearson")
# turn data into long format
cor_df <- as.data.frame(as.table(cor_mat))
names(cor_df) <- c("Var1", "Var2", "Correlation")
#plot the heatmap
ggplot(cor_df, aes(x = Var1, y = Var2, fill = Correlation)) +
geom_tile() +
scale_fill_gradient2(
limits = c(-1, 1),
midpoint = 0,
low = "blue",
mid = "white",
high = "red"
) +
coord_fixed() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank(),
axis.title.y = element_blank()
) +
ggtitle("Pearson Correlation Heatmap")
library(tidyverse)
library(haven)
library(ggplot2)
library(dplyr)
library(plotly)
# heatmap
# make a numeric-only version of your data:
data_num <- data %>%
mutate(across(
where(~ inherits(.x, "Date")),  # is it a Date?
as.numeric
))
# calculate correlations
cor_mat <- cor(data_num, use = "pairwise.complete.obs", method = "pearson")
# turn data into long format
cor_df <- as.data.frame(as.table(cor_mat))
names(cor_df) <- c("Var1", "Var2", "Correlation")
# base heatmap (your old ggplot)
p <- ggplot(cor_df, aes(x = Var1, y = Var2, fill = Correlation)) +
geom_tile() +
scale_fill_gradient2(
limits   = c(-1, 1),
midpoint = 0,
low      = "blue",
mid      = "white",
high     = "red"
) +
coord_fixed() +
theme_minimal() +
theme(
axis.text.x  = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank(),
axis.title.y = element_blank()
) +
ggtitle("Pearson Correlation Heatmap")
# ðŸ”¥ make it interactive
ggplotly(p)
# heatmap
# make a numeric-only version of your data:
data_num <- data %>%
mutate(across(
where(~ inherits(.x, "Date")),  # is it a Date?
as.numeric
))
# Remove columns with zero variance
is_constant <- sapply(data_num, function(x) sd(x, na.rm = TRUE) == 0)
data_num2 <- data_num[, !is_constant]
sum(is_constant)  # just to see how many you removed (optional)
# calculate correlations
cor_mat <- cor(data_num, use = "pairwise.complete.obs", method = "pearson")
# turn data into long format
cor_df <- as.data.frame(as.table(cor_mat))
names(cor_df) <- c("Var1", "Var2", "Correlation")
# base heatmap (your old ggplot)
p <- ggplot(cor_df, aes(x = Var1, y = Var2, fill = Correlation)) +
geom_tile() +
scale_fill_gradient2(
limits   = c(-1, 1),
midpoint = 0,
low      = "blue",
mid      = "white",
high     = "red"
) +
coord_fixed() +
theme_minimal() +
theme(
axis.text.x  = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank(),
axis.title.y = element_blank()
) +
ggtitle("Pearson Correlation Heatmap")
# ðŸ”¥ make it interactive
ggplotly(p)
# heatmap
# make a numeric-only version of your data:
data_num <- data %>%
mutate(across(
where(~ inherits(.x, "Date")),  # <- predicate: is it a Date?
as.numeric
))
# calculate correlations
cor_mat <- cor(data_num, use = "pairwise.complete.obs", method = "pearson")
# turn data into long format
cor_df <- as.data.frame(as.table(cor_mat))
names(cor_df) <- c("Var1", "Var2", "Correlation")
#plot the heatmap
ggplot(cor_df, aes(x = Var1, y = Var2, fill = Correlation)) +
geom_tile() +
scale_fill_gradient2(
limits = c(-1, 1),
midpoint = 0,
low = "blue",
mid = "white",
high = "red"
) +
coord_fixed() +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 45, hjust = 1),
axis.title.x = element_blank(),
axis.title.y = element_blank()
) +
ggtitle("Pearson Correlation Heatmap")
# heatmap
# make a numeric-only version of your data:
data_num <- data %>%
mutate(across(
where(~ inherits(.x, "Date")),  # <- predicate: is it a Date?
as.numeric
))
# calculate correlations
cor_mat <- cor(data_num, use = "pairwise.complete.obs", method = "pearson")
library(plotly)
plot_ly(
x = colnames(cor_mat),
y = rownames(cor_mat),
z = cor_mat,
type = "heatmap",
zmin = -1,
zmax = 1,
colorscale = "RdBu",
reversescale = TRUE,
hovertemplate = paste(
"Var1: %{x}<br>",
"Var2: %{y}<br>",
"Correlation: %{z:.2f}<extra></extra>"
)
) %>%
layout(
title = "Pearson Correlation Heatmap",
xaxis = list(title = ""),
yaxis = list(title = "")
)
# heatmap
# make a numeric-only version of your data:
data_num <- data %>%
mutate(across(
where(~ inherits(.x, "Date")),  # <- predicate: is it a Date?
as.numeric
))
# calculate correlations
cor_mat <- cor(data_num, use = "pairwise.complete.obs", method = "pearson")
library(plotly)
# custom redâ€“whiteâ€“blue colorscale: blue (negative) â†’ white (0) â†’ red (positive)
rwb_scale <- list(
list(0.0, "blue"),
list(0.5, "white"),
list(1.0, "red")
)
plot_ly(
x = colnames(cor_mat),
y = rownames(cor_mat),
z = cor_mat,
type = "heatmap",
zmin = -1,
zmax = 1,
colorscale = rwb_scale,
hovertemplate = paste(
"Var1: %{x}<br>",
"Var2: %{y}<br>",
"Correlation: %{z:.2f}<extra></extra>"
)
) %>%
layout(
title = list(
text = "Pearson Correlation Heatmap",
x = 0.5,
xanchor = "center"
),
xaxis = list(
title = "",
tickangle = -45,
tickfont = list(size = 9)
),
yaxis = list(
title = "",
tickfont = list(size = 9,
automargin = TRUE)
),
margin = list(l = 80, r = 20, b = 120, t = 50),
coloraxis = list(
colorbar = list(
title = "r",
ticksuffix = "",
len = 0.8
)
)
)
